---

title: "map"
author: "Qi Shao"
date: "12/2/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(rgdal)
```

```{r}
mydat = rgdal::readOGR("./UHF42/UHF_42_DOHMH.shp")
plot(mydat)
names(mydat)
mydat$UHF

mydat@data
names(mydat)
ggplot() +
  geom_polygon(data=mydat, aes(x=long, y=lat, group=group))+
  coord_map()


ggplot(data = mydat, mapping = aes(x = long, y = lat, group = group)) + 
  geom_polygon(data = mydat, fill = NA, color = "white") +
  geom_polygon(color = "black", fill = NA) 

fortify(mydat) %>% 
  filter(id == 1)
  

length(mydat)
mydat$UHFCODE
names(mydat)
table(iconv(mydat$UHFCODE, from = "GBK"))


neighb0 = Shanghai = mydat[mydat$UHFCODE == 501,]
plot(neighb0)

fortify(neighb0)

map_data = fortify(mydat) %>%
  dplyr::select(id, everything() )%>%
  nest(long:group)
map_data$uhf = mydat$UHFCODE

map_data = map_data %>%
  unnest
```


